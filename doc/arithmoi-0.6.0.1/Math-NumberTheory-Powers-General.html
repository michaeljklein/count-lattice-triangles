<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Math.NumberTheory.Powers.General</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Math.NumberTheory.Powers.General.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">arithmoi-0.6.0.1: Efficient basic number-theoretic functions.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) 2011 Daniel Fischer</td></tr><tr><th>License</th><td>MIT</td></tr><tr><th>Maintainer</th><td>Daniel Fischer &lt;daniel.is.fischer@googlemail.com&gt;</td></tr><tr><th>Stability</th><td>Provisional</td></tr><tr><th>Portability</th><td>Non-portable (GHC extensions)</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Math.NumberTheory.Powers.General</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Calculating integer roots and determining perfect powers.
 The algorithms are moderately efficient.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:integerRoot">integerRoot</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> b) =&gt; b -&gt; a -&gt; a</li><li class="src short"><a href="#v:exactRoot">exactRoot</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> b) =&gt; b -&gt; a -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> a</li><li class="src short"><a href="#v:isKthPower">isKthPower</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> b) =&gt; b -&gt; a -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:isPerfectPower">isPerfectPower</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:highestPower">highestPower</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; (a, <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>)</li><li class="src short"><a href="#v:largePFPower">largePFPower</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>)</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:integerRoot" class="def">integerRoot</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> b) =&gt; b -&gt; a -&gt; a <a href="src/Math.NumberTheory.Powers.General.html#integerRoot" class="link">Source</a> <a href="#v:integerRoot" class="selflink">#</a></p><div class="doc"><p>Calculate an integer root, <code><code><a href="Math-NumberTheory-Powers-General.html#v:integerRoot">integerRoot</a></code> k n</code> computes the (floor of) the <code>k</code>-th
   root of <code>n</code>, where <code>k</code> must be positive.
   <code>r = <code><a href="Math-NumberTheory-Powers-General.html#v:integerRoot">integerRoot</a></code> k n</code> means <code>r^k &lt;= n &lt; (r+1)^k</code> if that is possible at all.
   It is impossible if <code>k</code> is even and <code>n &lt; 0</code>, since then <code>r^k &gt;= 0</code> for all <code>r</code>,
   then, and if <code>k &lt;= 0</code>, <code><code><a href="Math-NumberTheory-Powers-General.html#v:integerRoot">integerRoot</a></code></code> raises an error. For <code>k &lt; 5</code>, a specialised
   version is called which should be more efficient than the general algorithm.
   However, it is not guaranteed that the rewrite rules for those fire, so if <code>k</code> is
   known in advance, it is safer to directly call the specialised versions.</p></div></div><div class="top"><p class="src"><a id="v:exactRoot" class="def">exactRoot</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> b) =&gt; b -&gt; a -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> a <a href="src/Math.NumberTheory.Powers.General.html#exactRoot" class="link">Source</a> <a href="#v:exactRoot" class="selflink">#</a></p><div class="doc"><p><code><code><a href="Math-NumberTheory-Powers-General.html#v:exactRoot">exactRoot</a></code> k n</code> returns <code><code><a href="../base-4.10.1.0/Data-Maybe.html#v:Nothing">Nothing</a></code></code> if <code>n</code> is not a <code>k</code>-th power,
   <code><code><a href="../base-4.10.1.0/Data-Maybe.html#v:Just">Just</a></code> r</code> if <code>n == r^k</code>. If <code>k</code> is divisible by <code>4, 3</code> or <code>2</code>, a
   residue test is performed to avoid the expensive calculation if it
   can thus be determined that <code>n</code> is not a <code>k</code>-th power.</p></div></div><div class="top"><p class="src"><a id="v:isKthPower" class="def">isKthPower</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> b) =&gt; b -&gt; a -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Math.NumberTheory.Powers.General.html#isKthPower" class="link">Source</a> <a href="#v:isKthPower" class="selflink">#</a></p><div class="doc"><p><code><code><a href="Math-NumberTheory-Powers-General.html#v:isKthPower">isKthPower</a></code> k n</code> checks whether <code>n</code> is a <code>k</code>-th power.</p></div></div><div class="top"><p class="src"><a id="v:isPerfectPower" class="def">isPerfectPower</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Math.NumberTheory.Powers.General.html#isPerfectPower" class="link">Source</a> <a href="#v:isPerfectPower" class="selflink">#</a></p><div class="doc"><p><code><code><a href="Math-NumberTheory-Powers-General.html#v:isPerfectPower">isPerfectPower</a></code> n</code> checks whether <code>n == r^k</code> for some <code>k &gt; 1</code>.</p></div></div><div class="top"><p class="src"><a id="v:highestPower" class="def">highestPower</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; (a, <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>) <a href="src/Math.NumberTheory.Powers.General.html#highestPower" class="link">Source</a> <a href="#v:highestPower" class="selflink">#</a></p><div class="doc"><p><code><code><a href="Math-NumberTheory-Powers-General.html#v:highestPower">highestPower</a></code> n</code> produces the pair <code>(b,k)</code> with the largest
   exponent <code>k</code> such that <code>n == b^k</code>, except for <code><code><a href="../base-4.10.1.0/Prelude.html#v:abs">abs</a></code> n &lt;= 1</code>,
   in which case arbitrarily large exponents exist, and by an
   arbitrary decision <code>(n,3)</code> is returned.</p><p>First, by trial division with small primes, the range of possible
   exponents is reduced (if <code>p^e</code> exactly divides <code>n</code>, then <code>k</code> must
   be a divisor of <code>e</code>, if several small primes divide <code>n</code>, <code>k</code> must
   divide the greatest common divisor of their exponents, which mostly
   will be <code>1</code>, generally small; if none of the small primes divides
   <code>n</code>, the range of possible exponents is reduced since the base is
   necessarily large), if that has not yet determined the result, the
   remaining factor is examined by trying the divisors of the <code>gcd</code>
   of the prime exponents if some have been found, otherwise by trying
   prime exponents recursively.</p></div></div><div class="top"><p class="src"><a id="v:largePFPower" class="def">largePFPower</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>) <a href="src/Math.NumberTheory.Powers.General.html#largePFPower" class="link">Source</a> <a href="#v:largePFPower" class="selflink">#</a></p><div class="doc"><p><code><code><a href="Math-NumberTheory-Powers-General.html#v:largePFPower">largePFPower</a></code> bd n</code> produces the pair <code>(b,k)</code> with the largest
   exponent <code>k</code> such that <code>n == b^k</code>, where <code>bd &gt; 1</code> (it is expected
   that <code>bd</code> is much larger, at least <code>1000</code> or so), <code>n &gt; bd^2</code> and <code>n</code>
   has no prime factors <code>p &lt;= bd</code>, skipping the trial division phase
   of <code><code><a href="Math-NumberTheory-Powers-General.html#v:highestPower">highestPower</a></code></code> when that is a priori known to be superfluous.
   It is only present to avoid duplication of work in factorisation
   and primality testing, it is not expected to be generally useful.
   The assumptions are not checked, if they are not satisfied, wrong
   results and wasted work may be the consequence.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.18.1</p></div></body></html>