<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- Module:      Math.NumberTheory.GCD</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- Copyright:   (c) 2011 Daniel Fischer</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Licence:     MIT</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Maintainer:  Daniel Fischer &lt;daniel.is.fischer@googlemail.com&gt;</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Stability:   Provisional</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Portability: Non-portable (GHC extensions)</span><span>
</span><a name="line-8"></a><span class="hs-comment">--</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- This module exports GCD and coprimality test using the binary gcd algorithm</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- and GCD with the extended Euclidean algorithm.</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- Efficiently counting the number of trailing zeros, the binary gcd algorithm</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- can perform considerably faster than the Euclidean algorithm on average.</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- For 'Int', GHC has a rewrite rule to use GMP's fast gcd, depending on</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- hardware and\/or GMP version, that can be faster or slower than the binary</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- algorithm (on my 32-bit box, binary is faster, on my 64-bit box, GMP).</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- For 'Word' and the sized @IntN\/WordN@ types, there is no rewrite rule (yet)</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- in GHC, and the binary algorithm performs consistently (so far as my tests go)</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- much better (if this module's rewrite rules fire).</span><span>
</span><a name="line-20"></a><span class="hs-comment">--</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- When using this module, always compile with optimisations turned on to</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- benefit from GHC's primops and the rewrite rules.</span><span>
</span><a name="line-23"></a><span class="hs-pragma">{-# LANGUAGE CPP, BangPatterns, MagicHash #-}</span><span>
</span><a name="line-24"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">NumberTheory</span><span class="hs-operator">.</span><span class="hs-identifier">GCD</span><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Math.NumberTheory.GCD.html#binaryGCD"><span class="hs-identifier hs-var">binaryGCD</span></a><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Math.NumberTheory.GCD.html#extendedGCD"><span class="hs-identifier hs-var">extendedGCD</span></a><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Math.NumberTheory.GCD.html#coprime"><span class="hs-identifier hs-var">coprime</span></a><span>
</span><a name="line-28"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Bits</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Word</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Int</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="Math.NumberTheory.GCD.LowLevel.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">NumberTheory</span><span class="hs-operator">.</span><span class="hs-identifier">GCD</span><span class="hs-operator">.</span><span class="hs-identifier">LowLevel</span></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="Math.NumberTheory.Utils.html"><span class="hs-identifier">Math</span><span class="hs-operator">.</span><span class="hs-identifier">NumberTheory</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-cpp">#include &quot;MachDeps.h&quot;</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-pragma">{-# RULES
&quot;binaryGCD/Int&quot;     binaryGCD = gcdInt
&quot;binaryGCD/Word&quot;    binaryGCD = gcdWord
&quot;binaryGCD/Int8&quot;    binaryGCD = gi8
&quot;binaryGCD/Int16&quot;   binaryGCD = gi16
&quot;binaryGCD/Int32&quot;   binaryGCD = gi32
&quot;binaryGCD/Word8&quot;   binaryGCD = gw8
&quot;binaryGCD/Word16&quot;  binaryGCD = gw16
&quot;binaryGCD/Word32&quot;  binaryGCD = gw32
  #-}</span><span>
</span><a name="line-49"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS == 64</span><span>
</span><a name="line-50"></a><span class="hs-identifier">gi64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int64</span><span>
</span><a name="line-51"></a><span class="hs-identifier">gi64</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I64</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-identifier hs-type">x</span><span class="hs-operator hs-type">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I64</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-identifier hs-type">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">I64</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gcdInt</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-identifier">gw64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word64</span><span>
</span><a name="line-54"></a><span class="hs-identifier">gw64</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W64</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-identifier hs-type">x</span><span class="hs-operator hs-type">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W64</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-identifier hs-type">y</span><span class="hs-operator hs-type">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">W64</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gcdWord</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-pragma">{-# RULES
&quot;binaryGCD/Int64&quot;   binaryGCD = gi64
&quot;binaryGCD/Word64&quot;  binaryGCD = gw64
  #-}</span><span>
</span><a name="line-60"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-61"></a><span class="hs-pragma">{-# INLINE [1] binaryGCD #-}</span><span>
</span><a name="line-62"></a><span class="hs-comment">-- | Calculate the greatest common divisor using the binary gcd algorithm.</span><span>
</span><a name="line-63"></a><span class="hs-comment">--   Depending on type and hardware, that can be considerably faster than</span><span>
</span><a name="line-64"></a><span class="hs-comment">--   @'Prelude.gcd'@ but it may also be significantly slower.</span><span>
</span><a name="line-65"></a><span class="hs-comment">--</span><span>
</span><a name="line-66"></a><span class="hs-comment">--   There are specialised functions for @'Int'@ and @'Word'@ and rewrite rules</span><span>
</span><a name="line-67"></a><span class="hs-comment">--   for those and @IntN@ and @WordN@, @N &lt;= WORD_SIZE_IN_BITS@, to use the</span><span>
</span><a name="line-68"></a><span class="hs-comment">--   specialised variants. These types are worth benchmarking, others probably not.</span><span>
</span><a name="line-69"></a><span class="hs-comment">--</span><span>
</span><a name="line-70"></a><span class="hs-comment">--   It is very slow for 'Integer' (and probably every type except the abovementioned),</span><span>
</span><a name="line-71"></a><span class="hs-comment">--   I recommend not using it for those.</span><span>
</span><a name="line-72"></a><span class="hs-comment">--</span><span>
</span><a name="line-73"></a><span class="hs-comment">--   Relies on twos complement or sign and magnitude representaion for signed types.</span><span>
</span><a name="line-74"></a><span class="hs-identifier">binaryGCD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integral</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Bits</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-75"></a><span class="hs-identifier">binaryGCD</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">binaryGCDImpl</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS &lt; 64</span><span>
</span><a name="line-78"></a><span class="hs-pragma">{-# SPECIALISE binaryGCDImpl :: Word64 -&gt; Word64 -&gt; Word64,
                                Int64 -&gt; Int64 -&gt; Int64 #-}</span><span>
</span><a name="line-80"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-81"></a><span class="hs-pragma">{-# SPECIALISE binaryGCDImpl :: Integer -&gt; Integer -&gt; Integer #-}</span><span>
</span><a name="line-82"></a><span class="hs-identifier">binaryGCDImpl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integral</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Bits</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-83"></a><span class="hs-identifier">binaryGCDImpl</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">abs</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-84"></a><span class="hs-identifier">binaryGCDImpl</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">abs</span><span> </span><span class="hs-identifier hs-type">b</span><span>
</span><a name="line-85"></a><a name="binaryGCDImpl"><a href="Math.NumberTheory.GCD.html#binaryGCDImpl"><span class="hs-identifier">binaryGCDImpl</span></a></a><span> </span><a name="local-6989586621679084689"><a href="#local-6989586621679084689"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">shiftToOddCount</span><span> </span><span class="hs-identifier">a'</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-87"></a><span>      </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">za</span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">oa</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-88"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">shiftToOddCount</span><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-89"></a><span>          </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">zb</span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">ob</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">gcdOdd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">abs</span><span> </span><span class="hs-identifier">oa</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">abs</span><span> </span><span class="hs-identifier">ob</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">shiftL</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">min</span><span> </span><span class="hs-identifier">za</span><span> </span><span class="hs-identifier">zb</span><span>
</span><a name="line-90"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-91"></a><span>      </span><span class="hs-identifier">a'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">abs</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-92"></a><span>      </span><span class="hs-identifier">b'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">abs</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-pragma">{-# SPECIALISE extendedGCD :: Int -&gt; Int -&gt; (Int, Int, Int),
                              Word -&gt; Word -&gt; (Word, Word, Word),
                              Integer -&gt; Integer -&gt; (Integer, Integer, Integer)
  #-}</span><span>
</span><a name="line-98"></a><span class="hs-comment">-- | Calculate the greatest common divisor of two numbers and coefficients</span><span>
</span><a name="line-99"></a><span class="hs-comment">--   for the linear combination.</span><span>
</span><a name="line-100"></a><span class="hs-comment">--</span><span>
</span><a name="line-101"></a><span class="hs-comment">--   For signed types satisfies:</span><span>
</span><a name="line-102"></a><span class="hs-comment">--</span><span>
</span><a name="line-103"></a><span class="hs-comment">-- &gt; case extendedGCD a b of</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- &gt;   (d, u, v) -&gt; u*a + v*b == d</span><span>
</span><a name="line-105"></a><span class="hs-comment">-- &gt;                &amp;&amp; d == gcd a b</span><span>
</span><a name="line-106"></a><span class="hs-comment">--</span><span>
</span><a name="line-107"></a><span class="hs-comment">--   For unsigned and bounded types the property above holds, but since @u@ and @v@ must also be unsigned,</span><span>
</span><a name="line-108"></a><span class="hs-comment">--   the result may look weird. E. g., on 64-bit architecture</span><span>
</span><a name="line-109"></a><span class="hs-comment">--</span><span>
</span><a name="line-110"></a><span class="hs-comment">-- &gt; extendedGCD (2 :: Word) (3 :: Word) == (1, 2^64-1, 1)</span><span>
</span><a name="line-111"></a><span class="hs-comment">--</span><span>
</span><a name="line-112"></a><span class="hs-comment">--   For unsigned and unbounded types (like 'Numeric.Natural.Natural') the result is undefined.</span><span>
</span><a name="line-113"></a><span class="hs-comment">--</span><span>
</span><a name="line-114"></a><span class="hs-comment">--   For signed types we also have</span><span>
</span><a name="line-115"></a><span class="hs-comment">--</span><span>
</span><a name="line-116"></a><span class="hs-comment">-- &gt; abs u &lt; abs b || abs b &lt;= 1</span><span>
</span><a name="line-117"></a><span class="hs-comment">-- &gt;</span><span>
</span><a name="line-118"></a><span class="hs-comment">-- &gt; abs v &lt; abs a || abs a &lt;= 1</span><span>
</span><a name="line-119"></a><span class="hs-comment">--</span><span>
</span><a name="line-120"></a><span class="hs-comment">--   (except if one of @a@ and @b@ is 'minBound' of a signed type).</span><span>
</span><a name="line-121"></a><span class="hs-identifier">extendedGCD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Integral</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span class="hs-identifier">extendedGCD</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">u</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">d</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">eGCD</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">abs</span><span> </span><a href="#local-6989586621679084682"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">abs</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>    </span><a name="extendedGCD"><a href="Math.NumberTheory.GCD.html#extendedGCD"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="extendedGCD"><a href="Math.NumberTheory.GCD.html#extendedGCD"><span class="hs-identifier">a</span></a></a><span> </span><a name="extendedGCD"><a href="Math.NumberTheory.GCD.html#extendedGCD"><span class="hs-operator">&lt;</span></a></a><span> </span><span class="hs-number">0</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">negate</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-126"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-127"></a><span>    </span><span class="hs-identifier">v</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679084702"><a href="#local-6989586621679084702"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">0</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">negate</span><span> </span><span class="hs-identifier">y</span><span>
</span><a name="line-128"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">y</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-identifier">eGCD</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-var">n1</span><span> </span><span class="hs-identifier hs-var">o1</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">n2</span><span> </span><span class="hs-identifier">o2</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-130"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679084700"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-number">0</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">r</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">o1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">o2</span><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">quotRem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-132"></a><span>                      </span><span class="hs-special">(</span><a name="local-6989586621679084711"><a href="#local-6989586621679084711"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">eGCD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">o1</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">q</span><span class="hs-operator">*</span><span class="hs-identifier">n1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">o2</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">q</span><span class="hs-operator">*</span><span class="hs-identifier">n2</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n2</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">t</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-pragma">{-# RULES
&quot;coprime/Int&quot;       coprime = coprimeInt
&quot;coprime/Word&quot;      coprime = coprimeWord
&quot;coprime/Int8&quot;      coprime = ci8
&quot;coprime/Int16&quot;     coprime = ci16
&quot;coprime/Int32&quot;     coprime = ci32
&quot;coprime/Word8&quot;     coprime = cw8
&quot;coprime/Word16&quot;    coprime = cw16
&quot;coprime/Word32&quot;    coprime = cw32
  #-}</span><span>
</span><a name="line-144"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS == 64</span><span>
</span><a name="line-145"></a><span class="hs-identifier">ci64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-146"></a><span class="hs-identifier">ci64</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I64</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I64</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coprimeInt</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-identifier">cw64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word64</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-149"></a><span class="hs-identifier">cw64</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W64</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-identifier hs-type">x</span><span class="hs-operator hs-type">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W64</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-identifier hs-type">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coprimeWord</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-pragma">{-# RULES
&quot;coprime/Int64&quot;     coprime = ci64
&quot;coprime/Word64&quot;    coprime = cw64
  #-}</span><span>
</span><a name="line-155"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-156"></a><span class="hs-pragma">{-# INLINE [1] coprime #-}</span><span>
</span><a name="line-157"></a><span class="hs-comment">-- | Test whether two numbers are coprime using an abbreviated binary gcd algorithm.</span><span>
</span><a name="line-158"></a><span class="hs-comment">--   A little bit faster than checking @binaryGCD a b == 1@ if one of the arguments</span><span>
</span><a name="line-159"></a><span class="hs-comment">--   is even, much faster if both are even.</span><span>
</span><a name="line-160"></a><span class="hs-comment">--</span><span>
</span><a name="line-161"></a><span class="hs-comment">--   The remarks about performance at 'binaryGCD' apply here too, use this function</span><span>
</span><a name="line-162"></a><span class="hs-comment">--   only at the types with rewrite rules.</span><span>
</span><a name="line-163"></a><span class="hs-comment">--</span><span>
</span><a name="line-164"></a><span class="hs-comment">--   Relies on twos complement or sign and magnitude representaion for signed types.</span><span>
</span><a name="line-165"></a><span class="hs-identifier">coprime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integral</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Bits</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-166"></a><span class="hs-identifier">coprime</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coprimeImpl</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-comment">-- Separate implementation to give the rules a chance to fire by not inlining</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- before phase 1, and yet have a specialisation for the types without rules</span><span>
</span><a name="line-170"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS &lt; 64</span><span>
</span><a name="line-171"></a><span class="hs-pragma">{-# SPECIALISE coprimeImpl :: Word64 -&gt; Word64 -&gt; Bool,
                              Int64 -&gt; Int64 -&gt; Bool #-}</span><span>
</span><a name="line-173"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-174"></a><span class="hs-pragma">{-# SPECIALISE coprimeImpl :: Integer -&gt; Integer -&gt; Bool #-}</span><span>
</span><a name="line-175"></a><span class="hs-identifier">coprimeImpl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integral</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Bits</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-176"></a><span class="hs-identifier">coprimeImpl</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-177"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">a'</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span>  </span><span class="hs-operator">||</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a'</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-operator">/=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-179"></a><span>      </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">gcdOdd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">abs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">shiftToOdd</span><span> </span><span class="hs-identifier hs-type">a'</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">abs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">shiftToOdd</span><span> </span><span class="hs-identifier">b'</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-181"></a><span>      </span><a name="coprimeImpl"><a href="Math.NumberTheory.GCD.html#coprimeImpl"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">abs</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-182"></a><span>      </span><span class="hs-identifier hs-var">b'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">abs</span><span> </span><a href="#local-6989586621679084722"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- Auxiliaries</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-comment">-- gcd of two odd numbers</span><span>
</span><a name="line-187"></a><span class="hs-pragma">{-# INLINE gcdOdd #-}</span><span>
</span><a name="line-188"></a><span class="hs-identifier">gcdOdd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integral</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Bits</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-189"></a><span class="hs-identifier">gcdOdd</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-190"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-number">1</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-191"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">b</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">oddGCD</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-192"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-identifier">b</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">oddGCD</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-193"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">a</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-pragma">{-# SPECIALISE oddGCD :: Integer -&gt; Integer -&gt; Integer #-}</span><span>
</span><a name="line-196"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS &lt; 64</span><span>
</span><a name="line-197"></a><span class="hs-pragma">{-# SPECIALISE oddGCD :: Int64 -&gt; Int64 -&gt; Int64,
                         Word64 -&gt; Word64 -&gt; Word64
  #-}</span><span>
</span><a name="line-200"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-201"></a><span class="hs-identifier">oddGCD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integral</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Bits</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-202"></a><span class="hs-identifier">oddGCD</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">shiftToOdd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-glyph">-</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-204"></a><span>      </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-205"></a><span>      </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-identifier">b</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">oddGCD</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-206"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-operator hs-type">&gt;</span><span> </span><span class="hs-identifier hs-type">b</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">oddGCD</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-207"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-210"></a><span class="hs-comment">--                Blech! Getting the rules to fire isn't easy.               --</span><span>
</span><a name="line-211"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-identifier">gi8</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int8</span><span>
</span><a name="line-214"></a><span class="hs-identifier">gi8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I8</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I8</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">I8</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gcdInt</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-identifier">gi16</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int16</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int16</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int16</span><span>
</span><a name="line-217"></a><span class="hs-identifier">gi16</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I16</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I16</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">I16</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gcdInt</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-identifier">gi32</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int32</span><span>
</span><a name="line-220"></a><span class="hs-identifier">gi32</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I32</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I32</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">I32</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gcdInt</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><a name="gi16"><a href="Math.NumberTheory.GCD.html#gi16"><span class="hs-identifier">gw8</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word8</span><span>
</span><a name="line-223"></a><span class="hs-identifier">gw8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W8</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W8</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">W8</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gcdWord</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><a name="gi32"><a href="Math.NumberTheory.GCD.html#gi32"><span class="hs-identifier">gw16</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word16</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word16</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word16</span><span>
</span><a name="line-226"></a><span class="hs-identifier">gw16</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W16</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W16</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">W16</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gcdWord</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-identifier">gw32</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word32</span><span>
</span><a name="line-229"></a><span class="hs-identifier">gw32</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W32</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W32</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">W32</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gcdWord</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><a name="gw16"><a href="Math.NumberTheory.GCD.html#gw16"><span class="hs-identifier">ci8</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-232"></a><span class="hs-identifier">ci8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I8</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I8</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coprimeInt</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><a name="gw32"><a href="Math.NumberTheory.GCD.html#gw32"><span class="hs-identifier">ci16</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int16</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int16</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-235"></a><span class="hs-identifier">ci16</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I16</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I16</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coprimeInt</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-identifier">ci32</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.NumberTheory.GCD.LowLevel.html#coprimeInt%23"><span class="hs-identifier hs-var">Bool</span></a><span>
</span><a name="line-238"></a><span class="hs-identifier">ci32</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I32</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I32</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coprimeInt</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><a name="ci16"><a href="Math.NumberTheory.GCD.html#ci16"><span class="hs-identifier">cw8</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><a name="line-241"></a><span class="hs-identifier">cw8</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W8</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W8</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coprimeWord</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><a name="ci32"><a href="Math.NumberTheory.GCD.html#ci32"><span class="hs-identifier">cw16</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word16</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word16</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.NumberTheory.GCD.LowLevel.html#coprimeInt%23"><span class="hs-identifier hs-var">Bool</span></a><span>
</span><a name="line-244"></a><span class="hs-identifier">cw16</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W16</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W16</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coprimeWord</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-identifier">cw32</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Math.NumberTheory.GCD.LowLevel.html#coprimeWord%23"><span class="hs-identifier hs-var">Bool</span></a><span>
</span><a name="line-247"></a><span class="hs-identifier">cw32</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W32</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W32</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">coprimeWord</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">x</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">y</span><span class="hs-operator">#</span><span>
</span><a name="line-248"></a></pre></body></html>