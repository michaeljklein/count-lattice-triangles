<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Lib</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Lib.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">count-lattice-triangles-0.1.0.0</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Lib</p></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:prompt">prompt</a> :: ()</li><li class="src short"><a href="#v:lemma1">lemma1</a> :: ()</li><li class="src short"><a href="#v:embeddable">embeddable</a> :: ()</li><li class="src short"><a href="#v:rationalEmbeddableNotes">rationalEmbeddableNotes</a> :: ()</li><li class="src short"><a href="#v:testTriple">testTriple</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; (a, a, a) -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:orderedTriples">orderedTriples</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; [(a, a, a)]</li><li class="src short"><a href="#v:ideaChangeRep">ideaChangeRep</a> :: ()</li><li class="src short"><a href="#v:-61--61--62-">(==&gt;)</a> :: <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:pSquare">pSquare</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; a -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:sqrtLeqGeq">sqrtLeqGeq</a> :: ()</li><li class="src short"><a href="#v:pairsBetween">pairsBetween</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Enum">Enum</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; a -&gt; a -&gt; [(a, a)]</li><li class="src short"><a href="#v:integerRoot">integerRoot</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; a -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> a</li><li class="src short"><a href="#v:sqrtLeq">sqrtLeq</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; a -&gt; a</li><li class="src short"><a href="#v:sqrtGeq">sqrtGeq</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; a -&gt; a</li><li class="src short"><a href="#v:pDiv">pDiv</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; a -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> a</li><li class="src short"><a href="#v:pSquareIsos">pSquareIsos</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a> -&gt; (a, a)</li><li class="src short"><a href="#v:pointPairs">pointPairs</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Enum">Enum</a> a) =&gt; a -&gt; [((a, a), (a, a))]</li><li class="src short"><a href="#v:extendingPointResults">extendingPointResults</a> :: ()</li><li class="src short"><a href="#v:lengthTriples">lengthTriples</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Enum">Enum</a> a) =&gt; a -&gt; [<a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (a, a, a)]</li><li class="src short"><a href="#v:lengthTriple">lengthTriple</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; ((a, a), (a, a)) -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (a, a, a)</li><li class="src short"><a href="#v:sortBy3">sortBy3</a> :: (a -&gt; a -&gt; <a href="../base-4.10.1.0/Data-Ord.html#t:Ordering">Ordering</a>) -&gt; (a, a, a) -&gt; (a, a, a)</li><li class="src short"><a href="#v:areaRoot">areaRoot</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; (a, a, a) -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> a</li><li class="src short"><a href="#v:areaRootPow2">areaRootPow2</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; (a, a, a) -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> a</li><li class="src short"><a href="#v:areaRoots">areaRoots</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; [<a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> ((a, a, a), a)]</li><li class="src short"><a href="#v:areaMap">areaMap</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; ((a, a), (a, a)) -&gt; <a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (<a href="../containers-0.5.10.2/Data-Set-Internal.html#t:Set">Set</a> (a, a, a))</li><li class="src short"><a href="#v:areaMapPow2">areaMapPow2</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; ((a, a), (a, a)) -&gt; <a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (<a href="../containers-0.5.10.2/Data-Set-Internal.html#t:Set">Set</a> (a, a, a))</li><li class="src short"><a href="#v:isPow2">isPow2</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:mainFunc">mainFunc</a> :: <a href="../base-4.10.1.0/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:showmap">showmap</a> :: <a href="../base-4.10.1.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (<a href="../containers-0.5.10.2/Data-Set-Internal.html#t:Set">Set</a> a) -&gt; <a href="../base-4.10.1.0/Data-String.html#t:String">String</a></li><li class="src short"><a href="#v:printmap">printmap</a> :: <a href="../base-4.10.1.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (<a href="../containers-0.5.10.2/Data-Set-Internal.html#t:Set">Set</a> a) -&gt; <a href="../base-4.10.1.0/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:tt">tt</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Enum">Enum</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> p, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a) =&gt; p -&gt; [(a, a, a)]</li><li class="src short"><a href="#v:tt2">tt2</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Enum">Enum</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> p, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a) =&gt; p -&gt; [(a, a, a)]</li><li class="src short"><a href="#v:tt3">tt3</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> c =&gt; c -&gt; [((c, c, c, c), (c, c, c))]</li><li class="src short"><a href="#v:swaps">swaps</a> :: [(a, a)] -&gt; [(a, a)]</li><li class="src short"><a href="#v:tt4">tt4</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [((<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>), (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))]</li><li class="src short"><a href="#v:tt5">tt5</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)]</li><li class="src short"><a href="#v:tt6">tt6</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)])])]</li><li class="src short"><a href="#v:tt6-39-">tt6'</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a></li><li class="src short"><a href="#v:tt6Par">tt6Par</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="../monad-par-0.3.4.8/Control-Monad-Par-IO.html#t:ParIO">ParIO</a> <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Factor">Factor</a> = (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>)</li><li class="src short"><span class="keyword">type</span> <a href="#t:Factors">Factors</a> = [<a href="Lib.html#t:Factor">Factor</a>]</li><li class="src short"><a href="#v:divisorFactors">divisorFactors</a> :: <a href="Lib.html#t:Factors">Factors</a> -&gt; [<a href="Lib.html#t:Factors">Factors</a>]</li><li class="src short"><a href="#v:divisorSplits">divisorSplits</a> :: <a href="Lib.html#t:Factors">Factors</a> -&gt; [(<a href="Lib.html#t:Factors">Factors</a>, <a href="Lib.html#t:Factors">Factors</a>)]</li><li class="src short"><a href="#v:unFactor">unFactor</a> :: <a href="Lib.html#t:Factors">Factors</a> -&gt; <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a></li><li class="src short"><a href="#v:factorDivisors">factorDivisors</a> :: <a href="Lib.html#t:Factors">Factors</a> -&gt; [<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>]</li><li class="src short"><a href="#v:divisors">divisors</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>]</li><li class="src short"><a href="#v:products">products</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)]</li><li class="src short"><a href="#v:pairProducts">pairProducts</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)])])]</li><li class="src short"><a href="#v:pairProducts1">pairProducts1</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="../vector-0.12.0.1/Data-Vector.html#t:Vector">Vector</a> (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)])])</li><li class="src short"><a href="#v:pairProducts2">pairProducts2</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../vector-0.12.0.1/Data-Vector.html#t:Vector">Vector</a> (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)]))]</li><li class="src short"><a href="#v:qs">qs</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)]</li><li class="src short"><a href="#v:pts0">pts0</a> :: [([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))]</li><li class="src short"><a href="#v:pts1">pts1</a> :: [([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))]</li><li class="src short"><a href="#v:pts2">pts2</a> :: [([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))]</li><li class="src short"><a href="#v:pts3">pts3</a> :: [([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))]</li><li class="src short"><a href="#v:pts4">pts4</a> :: [([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))]</li><li class="src short"><a href="#v:pts5">pts5</a> :: [([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))]</li><li class="src short"><a href="#v:pts">pts</a> :: [[([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))]]</li><li class="src short"><a href="#v:simplifyFsts">simplifyFsts</a> :: <a href="../base-4.10.1.0/Data-Eq.html#t:Eq">Eq</a> a =&gt; [(a, b)] -&gt; [(a, [b])]</li><li class="src short"><a href="#v:bimax">bimax</a> :: (<a href="../base-4.10.1.0/Data-Traversable.html#t:Traversable">Traversable</a> t, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> b) =&gt; t (a, b) -&gt; (<a href="../base-4.10.1.0/Data-Semigroup.html#t:Max">Max</a> a, <a href="../base-4.10.1.0/Data-Semigroup.html#t:Max">Max</a> b)</li><li class="src short"><a href="#v:bimin">bimin</a> :: (<a href="../base-4.10.1.0/Data-Traversable.html#t:Traversable">Traversable</a> t, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> b) =&gt; t (a, b) -&gt; (<a href="../base-4.10.1.0/Data-Semigroup.html#t:Min">Min</a> a, <a href="../base-4.10.1.0/Data-Semigroup.html#t:Min">Min</a> b)</li><li class="src short"><a href="#v:bifold">bifold</a> :: (<a href="../base-4.10.1.0/Data-Traversable.html#t:Traversable">Traversable</a> t, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Data-Semigroup.html#t:Semigroup">Semigroup</a> a, <a href="../base-4.10.1.0/Data-Semigroup.html#t:Semigroup">Semigroup</a> b) =&gt; t (a, b) -&gt; (a, b)</li><li class="src short"><a href="#v:sortBy4">sortBy4</a> :: (a -&gt; a -&gt; <a href="../base-4.10.1.0/Data-Ord.html#t:Ordering">Ordering</a>) -&gt; (a, a, a, a) -&gt; (a, a, a, a)</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:prompt" class="def">prompt</a> :: () <a href="src/Lib.html#prompt" class="link">Source</a> <a href="#v:prompt" class="selflink">#</a></p><div class="doc"><p>Prompt:</p><pre> PROMPT:
  A &#8220;lattice point&#8221; is a point (x,y) on the Cartesian plane where x and y are integers.
  A &#8220;lattice triangle&#8221; is a triangle whose 3 vertices are all on lattice points.
  For positive integer n, how many non-congruent acute lattice triangles have area 2^n?
</pre></div></div><div class="top"><p class="src"><a id="v:lemma1" class="def">lemma1</a> :: () <a href="src/Lib.html#lemma1" class="link">Source</a> <a href="#v:lemma1" class="selflink">#</a></p><div class="doc"><p>LEMMA 1:</p><pre>   Acute iff a^2 &lt; b^2 + c^2, b^2 &lt; a^2 + c^2, c^2 &lt; a^2 + b^2
 Law of cosines:
 a^2 = b^2 + c^ - 2*b*c*cos x
 (b^2 + c^2 - a^2)/(2*b*c) = cos x

 for x in [0, pi]
   x &lt; pi/2 == 0 &lt; cos x

 0 &lt; (b^2 + c^2 - a^2)/(2*b*c)
 0 &lt; b^2 + c^2 - a^2
 a^2 &lt; b^2 + c^2
</pre></div></div><div class="top"><p class="src"><a id="v:embeddable" class="def">embeddable</a> :: () <a href="src/Lib.html#embeddable" class="link">Source</a> <a href="#v:embeddable" class="selflink">#</a></p><div class="doc"><p>A triangle is embeddable in <code>Z^2</code> iff all of it's angles have rational tangents</p><pre> tan a = opp / adj

     C
     |
     | 
 adj |a  h
     |   
     |[]__
     A opp B

           /|
          / | 
      lh /A | B rh
        /   |   
     l []   |h  [] r
      /*    |    *
     []i  * | *  j[]
 lu /     * | *      ru
   / C *    |    * D 
  *____<strong>_[]|[]</strong>_____*
      x          y

 tan C = h / x
 tan D = h / y
 tan (A + B) = i <em> lu = j </em> ru

 Let's assume Isosceles:
   tan C = h / x
   tan (2 * A) = i / lu

   tan x = sin x / cos x
   tan (2 * x) = (2 * sin x * cos x) / (cos x^2 - sin x^2)

 Ok, so this is embeddable in Z^2 iff tan(A+B), tan(C), tan(D) <code><a href="../base-4.10.1.0/Data-Foldable.html#v:elem">elem</a></code> Rational
</pre></div></div><div class="top"><p class="src"><a id="v:rationalEmbeddableNotes" class="def">rationalEmbeddableNotes</a> :: () <a href="src/Lib.html#rationalEmbeddableNotes" class="link">Source</a> <a href="#v:rationalEmbeddableNotes" class="selflink">#</a></p><div class="doc"><p>Notes on embeddability:</p><pre> sin x^2 + cos x^2 == 1
 sin x^2 == 1 - cos x^2
 sin x == sqrt (1 - cos x^2)

 c^2 == a^2 + b^2 - 2 * a * b * cos C
 (a^2 + b^2 - c^2) / 2 * a * b == cos C
 ((a^2 + b^2 - c^2) / 2 * a * b)^2 == cos C^2
 1 - ((a^2 + b^2 - c^2) / 2 * a * b)^2 == 1 - cos C^2
 sqrt (1 - ((a^2 + b^2 - c^2) / 2 * a * b)^2) == sqrt (1 - cos C^2)
 sqrt (1 - ((a^2 + b^2 - c^2) <em> 2 * a * b)^2) </em> ((a^2 + b^2 - c^2) <em> 2 * a * b) == sqrt (1 - cos C^2) </em> cos C == tan C
 sqrt (1 - ((a^2 + b^2 - c^2) <em> 2 * a * b)^2) == tan C * ((a^2 + b^2 - c^2) </em> 2 * a * b)

 Since ((a^2 + b^2 - c^2) / 2 * a * b) is clearly rational, we only consider the remaining part:

 sqrt (1 - ((a^2 + b^2 - c^2) / 2 * a * b)^2)
 sqrt(1 - (1/4) * a^2 * b^2 * (a^2 + b^2 - c^2)^2)

 sqrt (1 - (c^2 / (a^2 + b^2 - 2 * a * b)))
 sqrt(1 - c^2<em>(a^2 + b^2 - 2 a b)) = sqrt(1 - c^2</em>(a - b)^2) =&gt; Result True
 sqrt (1 - c^2/(a - b)^2)

 We define: d = abs (a - b), unless a - b == 0

 sqrt (1 - c^2/d^2)
 sqrt (d^2<em>d^2 - c^2</em>d^2)
 sqrt ((d^2 - c^2)/d^2)
 sqrt (d^2 - c^2) * sqrt (d^2)
 sqrt (d^2 - c^2) * d -- since d is defined as an abs

 Again, d is clearly rational so we only consider the remaining part:

 sqrt (d^2 - c^2)

 Adding the implicit variable:

 sqrt (d^2 - c^2) == i
 d^2 - c^2 == i^2
 d^2 == i^2 + c^2

 This is equivalent to the statement that c, d are a leg, the hypotenuse, resp. of a primitive pythagorean triple.

 Replacing variables, we get:

 (abs (a - b)), c are the hypotenuse, a leg, resp. of a primitive pythagorean triple.

 Applying the formula around the triangle:
 Hypotenuse: (a - b) | (b - c) | (a - c)
 Leg:           c    |    a    |    b

 Lemma:
 There exist pythagorean triples for all three pairs IFF the triangle is embeddable in Z^2.

 2^(2*n) == 2 * (a^2 * b^2 + a^2 * c^2 + b^2 * c^2) - (a^4 + b^4 + c^4)

 2*(2*n) == (a + b + c) * (-a + b + c) * (a - b + c) * (a + b - c)

 a^2 &lt; b^2 + c^2
 b^2 &lt; a^2 + c^2
 c^2 &lt; a^2 + b^2
</pre></div></div><div class="top"><p class="src"><a id="v:testTriple" class="def">testTriple</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; (a, a, a) -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Lib.html#testTriple" class="link">Source</a> <a href="#v:testTriple" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:orderedTriples" class="def">orderedTriples</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; [(a, a, a)] <a href="src/Lib.html#orderedTriples" class="link">Source</a> <a href="#v:orderedTriples" class="selflink">#</a></p><div class="doc"><p>C
 ( bash -c &quot;stack exec -- basic-exe +RTS -N&quot;; )  413.63s user 24.86s system 149% cpu 4:52.50 total</p></div></div><div class="top"><p class="src"><a id="v:ideaChangeRep" class="def">ideaChangeRep</a> :: () <a href="src/Lib.html#ideaChangeRep" class="link">Source</a> <a href="#v:ideaChangeRep" class="selflink">#</a></p><div class="doc"><p>Idea:</p><pre> All of form:
 - pick base line
 - pick point in (beginning of base line,middle of base line]
 - draw lines from point to base

 Take base line to be (0,0) to (0, x):
 - Third point must be between (not including) 0 and x, and above

 tt =
   (x -&gt;
      [ (a, b, c)
      | let r = [0 .. x]
      , a &lt;- r
      , b &lt;- r
      , c &lt;- r
      , not $
          (a ^ 2 &lt; b ^ 2 + c ^ 2 &amp;&amp;
           b ^ 2 <a href="a">^ 2 + c ^ 2 &amp;&amp; c ^ 2 &lt; a ^ 2 + b ^ 2) ==</a>
          (a &lt; b + c &amp;&amp; b &lt; a + c &amp;&amp; c &lt; a + b)
      ])

 Ok, so those inequalities give us acute triangles.

 What about congruence? (Really similarity since we already have equal areas)
</pre></div></div><div class="top"><p class="src"><a id="v:-61--61--62-" class="def">(==&gt;)</a> :: <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Lib.html#%3D%3D%3E" class="link">Source</a> <a href="#v:-61--61--62-" class="selflink">#</a></p><div class="doc"><p>Logical implication</p></div></div><div class="top"><p class="src"><a id="v:pSquare" class="def">pSquare</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; a -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Lib.html#pSquare" class="link">Source</a> <a href="#v:pSquare" class="selflink">#</a></p><div class="doc"><p>Is the number a square?</p></div></div><div class="top"><p class="src"><a id="v:sqrtLeqGeq" class="def">sqrtLeqGeq</a> :: () <a href="src/Lib.html#sqrtLeqGeq" class="link">Source</a> <a href="#v:sqrtLeqGeq" class="selflink">#</a></p><div class="doc"><p>What about all points within a given distance to the origin?</p><pre> sqrtLeq :: (Num a, Ord a) =&gt; a -&gt; a
 sqrtLeq x | exists i. i^2 == x = i
           | otherwise        = max_i. i^2 &lt; x = i

 sqrtGeq :: (Num a, Ord a) =&gt; a -&gt; a
 sqrtGeq x | exists i. i^2 == x = i
           | otherwise        = min_i. i^2 &gt; x = i

 sqrtLeq x &lt;= sqrt x &lt;= sqrtGeq x
</pre></div></div><div class="top"><p class="src"><a id="v:pairsBetween" class="def">pairsBetween</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Enum">Enum</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; a -&gt; a -&gt; [(a, a)] <a href="src/Lib.html#pairsBetween" class="link">Source</a> <a href="#v:pairsBetween" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:integerRoot" class="def">integerRoot</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; a -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> a <a href="src/Lib.html#integerRoot" class="link">Source</a> <a href="#v:integerRoot" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:sqrtLeq" class="def">sqrtLeq</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; a -&gt; a <a href="src/Lib.html#sqrtLeq" class="link">Source</a> <a href="#v:sqrtLeq" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:sqrtGeq" class="def">sqrtGeq</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; a -&gt; a <a href="src/Lib.html#sqrtGeq" class="link">Source</a> <a href="#v:sqrtGeq" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pDiv" class="def">pDiv</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; a -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> a <a href="src/Lib.html#pDiv" class="link">Source</a> <a href="#v:pDiv" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pSquareIsos" class="def">pSquareIsos</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a =&gt; <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a> -&gt; (a, a) <a href="src/Lib.html#pSquareIsos" class="link">Source</a> <a href="#v:pSquareIsos" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pointPairs" class="def">pointPairs</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Enum">Enum</a> a) =&gt; a -&gt; [((a, a), (a, a))] <a href="src/Lib.html#pointPairs" class="link">Source</a> <a href="#v:pointPairs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:extendingPointResults" class="def">extendingPointResults</a> :: () <a href="src/Lib.html#extendingPointResults" class="link">Source</a> <a href="#v:extendingPointResults" class="selflink">#</a></p><div class="doc"><p>Extending partial results:</p><pre>Suppose we have to n, and we want to extend to m

what do we need?
  We can split into catch-up and new
    catch up involves values &lt;= n

  x &lt;- [n+1..m], y &lt;- [1..m], z &lt;- [1..m], w &lt;- [1..m]]
</pre></div></div><div class="top"><p class="src"><a id="v:lengthTriples" class="def">lengthTriples</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Enum">Enum</a> a) =&gt; a -&gt; [<a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (a, a, a)] <a href="src/Lib.html#lengthTriples" class="link">Source</a> <a href="#v:lengthTriples" class="selflink">#</a></p><div class="doc"><p>Squared lengths of triangles</p></div></div><div class="top"><p class="src"><a id="v:lengthTriple" class="def">lengthTriple</a> :: (<a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a) =&gt; ((a, a), (a, a)) -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (a, a, a) <a href="src/Lib.html#lengthTriple" class="link">Source</a> <a href="#v:lengthTriple" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:sortBy3" class="def">sortBy3</a> :: (a -&gt; a -&gt; <a href="../base-4.10.1.0/Data-Ord.html#t:Ordering">Ordering</a>) -&gt; (a, a, a) -&gt; (a, a, a) <a href="src/Lib.html#sortBy3" class="link">Source</a> <a href="#v:sortBy3" class="selflink">#</a></p><div class="doc"><p>sort3ByIndex specified to triples
 <a href="http://hackage.haskell.org/package/vector-algorithms-0.7.0.1/docs/Data-Vector-Algorithms-Optimal.html#sort3ByIndex">http://hackage.haskell.org/package/vector-algorithms-0.7.0.1/docs/Data-Vector-Algorithms-Optimal.html#sort3ByIndex</a></p></div></div><div class="top"><p class="src"><a id="v:areaRoot" class="def">areaRoot</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; (a, a, a) -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> a <a href="src/Lib.html#areaRoot" class="link">Source</a> <a href="#v:areaRoot" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:areaRootPow2" class="def">areaRootPow2</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; (a, a, a) -&gt; <a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> a <a href="src/Lib.html#areaRootPow2" class="link">Source</a> <a href="#v:areaRootPow2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:areaRoots" class="def">areaRoots</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; [<a href="../base-4.10.1.0/Data-Maybe.html#t:Maybe">Maybe</a> ((a, a, a), a)] <a href="src/Lib.html#areaRoots" class="link">Source</a> <a href="#v:areaRoots" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:areaMap" class="def">areaMap</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; ((a, a), (a, a)) -&gt; <a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (<a href="../containers-0.5.10.2/Data-Set-Internal.html#t:Set">Set</a> (a, a, a)) <a href="src/Lib.html#areaMap" class="link">Source</a> <a href="#v:areaMap" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:areaMapPow2" class="def">areaMapPow2</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; ((a, a), (a, a)) -&gt; <a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (<a href="../containers-0.5.10.2/Data-Set-Internal.html#t:Set">Set</a> (a, a, a)) <a href="src/Lib.html#areaMapPow2" class="link">Source</a> <a href="#v:areaMapPow2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:isPow2" class="def">isPow2</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> a =&gt; a -&gt; <a href="../base-4.10.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Lib.html#isPow2" class="link">Source</a> <a href="#v:isPow2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mainFunc" class="def">mainFunc</a> :: <a href="../base-4.10.1.0/System-IO.html#t:IO">IO</a> () <a href="src/Lib.html#mainFunc" class="link">Source</a> <a href="#v:mainFunc" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:showmap" class="def">showmap</a> :: <a href="../base-4.10.1.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (<a href="../containers-0.5.10.2/Data-Set-Internal.html#t:Set">Set</a> a) -&gt; <a href="../base-4.10.1.0/Data-String.html#t:String">String</a> <a href="src/Lib.html#showmap" class="link">Source</a> <a href="#v:showmap" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:printmap" class="def">printmap</a> :: <a href="../base-4.10.1.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="../containers-0.5.10.2/Data-IntMap-Internal.html#t:IntMap">IntMap</a> (<a href="../containers-0.5.10.2/Data-Set-Internal.html#t:Set">Set</a> a) -&gt; <a href="../base-4.10.1.0/System-IO.html#t:IO">IO</a> () <a href="src/Lib.html#printmap" class="link">Source</a> <a href="#v:printmap" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tt" class="def">tt</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Enum">Enum</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> p, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a) =&gt; p -&gt; [(a, a, a)] <a href="src/Lib.html#tt" class="link">Source</a> <a href="#v:tt" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tt2" class="def">tt2</a> :: (<a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Enum">Enum</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> p, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a) =&gt; p -&gt; [(a, a, a)] <a href="src/Lib.html#tt2" class="link">Source</a> <a href="#v:tt2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tt3" class="def">tt3</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integral">Integral</a> c =&gt; c -&gt; [((c, c, c, c), (c, c, c))] <a href="src/Lib.html#tt3" class="link">Source</a> <a href="#v:tt3" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:swaps" class="def">swaps</a> :: [(a, a)] -&gt; [(a, a)] <a href="src/Lib.html#swaps" class="link">Source</a> <a href="#v:swaps" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tt4" class="def">tt4</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [((<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>), (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))] <a href="src/Lib.html#tt4" class="link">Source</a> <a href="#v:tt4" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tt5" class="def">tt5</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)] <a href="src/Lib.html#tt5" class="link">Source</a> <a href="#v:tt5" class="selflink">#</a></p><div class="doc"><p>tt5 gives us a decent speed-up over tt4,</p><p>&#955;&gt; length.tt4 $ 9
 224
 (5.54 secs, 7,264,138,936 bytes)
 &#955;&gt; length.tt4 $ 10
 476
 (25.81 secs, 33,678,207,000 bytes)</p><p>&#955;&gt; length.tt5 $ 9
 224
 (4.54 secs, 5,637,930,776 bytes)
 &#955;&gt; length.tt5 $ 10
 476
 (20.58 secs, 26,401,333,784 bytes)
 @</p><p>Looks like around a 25% speed up!</p></div></div><div class="top"><p class="src"><a id="v:tt6" class="def">tt6</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)])])] <a href="src/Lib.html#tt6" class="link">Source</a> <a href="#v:tt6" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tt6-39-" class="def">tt6'</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> <a href="src/Lib.html#tt6%27" class="link">Source</a> <a href="#v:tt6-39-" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tt6Par" class="def">tt6Par</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="../monad-par-0.3.4.8/Control-Monad-Par-IO.html#t:ParIO">ParIO</a> <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> <a href="src/Lib.html#tt6Par" class="link">Source</a> <a href="#v:tt6Par" class="selflink">#</a></p><div class="doc"><p>This is a very nice, fast implementation</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Factor" class="def">Factor</a> = (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Data-Int.html#t:Int">Int</a>) <a href="src/Lib.html#Factor" class="link">Source</a> <a href="#t:Factor" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Factors" class="def">Factors</a> = [<a href="Lib.html#t:Factor">Factor</a>] <a href="src/Lib.html#Factors" class="link">Source</a> <a href="#t:Factors" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:divisorFactors" class="def">divisorFactors</a> :: <a href="Lib.html#t:Factors">Factors</a> -&gt; [<a href="Lib.html#t:Factors">Factors</a>] <a href="src/Lib.html#divisorFactors" class="link">Source</a> <a href="#v:divisorFactors" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:divisorSplits" class="def">divisorSplits</a> :: <a href="Lib.html#t:Factors">Factors</a> -&gt; [(<a href="Lib.html#t:Factors">Factors</a>, <a href="Lib.html#t:Factors">Factors</a>)] <a href="src/Lib.html#divisorSplits" class="link">Source</a> <a href="#v:divisorSplits" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:unFactor" class="def">unFactor</a> :: <a href="Lib.html#t:Factors">Factors</a> -&gt; <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> <a href="src/Lib.html#unFactor" class="link">Source</a> <a href="#v:unFactor" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:factorDivisors" class="def">factorDivisors</a> :: <a href="Lib.html#t:Factors">Factors</a> -&gt; [<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>] <a href="src/Lib.html#factorDivisors" class="link">Source</a> <a href="#v:factorDivisors" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:divisors" class="def">divisors</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>] <a href="src/Lib.html#divisors" class="link">Source</a> <a href="#v:divisors" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:products" class="def">products</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)] <a href="src/Lib.html#products" class="link">Source</a> <a href="#v:products" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pairProducts" class="def">pairProducts</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)])])] <a href="src/Lib.html#pairProducts" class="link">Source</a> <a href="#v:pairProducts" class="selflink">#</a></p><div class="doc"><p><code><a href="Lib.html#v:pairProducts">pairProducts</a></code> implements a subset of the constraints much more efficiently than brute-forcing:
 <code>
  1 &lt;= x, y, z, w
  y * z &lt; x * w
  2^n = x * w - z * y
 </code></p><p>We find that the 1st + 3rd lines imply the second.
 We add the additional constraint that `y * z &lt;= 2^n`.
 This gives us a collection of (y's, z's).</p><dl><dt>(y, [(z, [(x, w)</dt><dd>)])]</dd></dl></div></div><div class="top"><p class="src"><a id="v:pairProducts1" class="def">pairProducts1</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; <a href="../vector-0.12.0.1/Data-Vector.html#t:Vector">Vector</a> (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)])]) <a href="src/Lib.html#pairProducts1" class="link">Source</a> <a href="#v:pairProducts1" class="selflink">#</a></p><div class="doc"><p>This gets the same performance as pairProducts, up to 1/2s error, n=11, ~22s</p></div></div><div class="top"><p class="src"><a id="v:pairProducts2" class="def">pairProducts2</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../vector-0.12.0.1/Data-Vector.html#t:Vector">Vector</a> (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)]))] <a href="src/Lib.html#pairProducts2" class="link">Source</a> <a href="#v:pairProducts2" class="selflink">#</a></p><div class="doc"><p>Curiously, this gets a bit more cpu utilization than pairProducts, pairProducts1.
 (up to n=11, where it seems to even out a bit)</p></div></div><div class="top"><p class="src"><a id="v:qs" class="def">qs</a> :: <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a> -&gt; [(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)] <a href="src/Lib.html#qs" class="link">Source</a> <a href="#v:qs" class="selflink">#</a></p><div class="doc"><p>Uses over 1 GB of memory for n=12
 pairProducts3 :: Integer -&gt; [(Integer, Vector (Integer, [(Integer, Integer)]))]
 pairProducts3 n = parMap rdeepseq (y -&gt; (y, V.generate (fromInteger tnm1) $ generator y . toInteger)) [1 .. tnm1]
   where
     tnm1 = 2 ^ (n - 1)
     tn = 2 * tnm1
     generator :: Integer -&gt; Integer -&gt; (Integer, [(Integer, Integer)])
     generator y' z = (z, products (tn + y' * z))</p></div></div><div class="top"><p class="src"><a id="v:pts0" class="def">pts0</a> :: [([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))] <a href="src/Lib.html#pts0" class="link">Source</a> <a href="#v:pts0" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pts1" class="def">pts1</a> :: [([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))] <a href="src/Lib.html#pts1" class="link">Source</a> <a href="#v:pts1" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pts2" class="def">pts2</a> :: [([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))] <a href="src/Lib.html#pts2" class="link">Source</a> <a href="#v:pts2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pts3" class="def">pts3</a> :: [([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))] <a href="src/Lib.html#pts3" class="link">Source</a> <a href="#v:pts3" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pts4" class="def">pts4</a> :: [([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))] <a href="src/Lib.html#pts4" class="link">Source</a> <a href="#v:pts4" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pts5" class="def">pts5</a> :: [([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))] <a href="src/Lib.html#pts5" class="link">Source</a> <a href="#v:pts5" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pts" class="def">pts</a> :: [[([(<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>)], (<a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>, <a href="../base-4.10.1.0/Prelude.html#t:Integer">Integer</a>))]] <a href="src/Lib.html#pts" class="link">Source</a> <a href="#v:pts" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:simplifyFsts" class="def">simplifyFsts</a> :: <a href="../base-4.10.1.0/Data-Eq.html#t:Eq">Eq</a> a =&gt; [(a, b)] -&gt; [(a, [b])] <a href="src/Lib.html#simplifyFsts" class="link">Source</a> <a href="#v:simplifyFsts" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:bimax" class="def">bimax</a> :: (<a href="../base-4.10.1.0/Data-Traversable.html#t:Traversable">Traversable</a> t, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> b) =&gt; t (a, b) -&gt; (<a href="../base-4.10.1.0/Data-Semigroup.html#t:Max">Max</a> a, <a href="../base-4.10.1.0/Data-Semigroup.html#t:Max">Max</a> b) <a href="src/Lib.html#bimax" class="link">Source</a> <a href="#v:bimax" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:bimin" class="def">bimin</a> :: (<a href="../base-4.10.1.0/Data-Traversable.html#t:Traversable">Traversable</a> t, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> a, <a href="../base-4.10.1.0/Data-Ord.html#t:Ord">Ord</a> b) =&gt; t (a, b) -&gt; (<a href="../base-4.10.1.0/Data-Semigroup.html#t:Min">Min</a> a, <a href="../base-4.10.1.0/Data-Semigroup.html#t:Min">Min</a> b) <a href="src/Lib.html#bimin" class="link">Source</a> <a href="#v:bimin" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:bifold" class="def">bifold</a> :: (<a href="../base-4.10.1.0/Data-Traversable.html#t:Traversable">Traversable</a> t, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> a, <a href="../base-4.10.1.0/Prelude.html#t:Num">Num</a> b, <a href="../base-4.10.1.0/Data-Semigroup.html#t:Semigroup">Semigroup</a> a, <a href="../base-4.10.1.0/Data-Semigroup.html#t:Semigroup">Semigroup</a> b) =&gt; t (a, b) -&gt; (a, b) <a href="src/Lib.html#bifold" class="link">Source</a> <a href="#v:bifold" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:sortBy4" class="def">sortBy4</a> :: (a -&gt; a -&gt; <a href="../base-4.10.1.0/Data-Ord.html#t:Ordering">Ordering</a>) -&gt; (a, a, a, a) -&gt; (a, a, a, a) <a href="src/Lib.html#sortBy4" class="link">Source</a> <a href="#v:sortBy4" class="selflink">#</a></p><div class="doc"><p>This factorization must multiply into a perfect square</p><p>It's a bit of a monster..</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.18.1</p></div></body></html>